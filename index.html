<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pixels with Video and Aura</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500&display=swap" rel="stylesheet" />
</head>
<body>

  <!-- Background Video Section -->
  <div class="video-container">
    <video id="bgVideo" class="background-video" src="background.mp4" muted loop playsinline></video>
    <div class="video-fade-out"></div>
  </div>

  <!-- Fixed "pixels" text and line -->
  <div class="wrapper">
    <div class="line"></div>
    <div class="text-container">
      <h1 class="pixels-text">â€Ž pixels</h1>
    </div>
  </div>

  <!-- Glowing Aura Section -->
  <div class="aura-section">
    <div class="glowing-aura" id="aura"></div>
  </div>

  <!-- Filler to test scroll -->
  <div class="filler"></div>

  <!-- BEGIN: Scroll Buttons with Popups -->
<div class="scroll-wrapper-2"></div>

<div class="button-container-2" id="buttonContainer-2">
  <div class="btn-2" data-index="0">1</div>
  <div class="btn-2" data-index="1">2</div>
  <div class="btn-2" data-index="2">3</div>
  <div class="btn-2" data-index="3">4</div>
</div>

<div class="beam-2" id="beam-2"></div>

<div class="popup-overlay-2" id="popupOverlay-2">
  <div class="popup-content-2">
    <div class="popup-close-2" id="popupClose-2"></div>
    <div class="popup-body-2" id="popupBody-2"></div>
  </div>
</div>
<!-- END: Scroll Buttons with Popups -->


<script>
setTimeout(() => {
  const buttonContainer = document.getElementById('buttonContainer-2');
  const buttons = Array.from(document.querySelectorAll('.btn-2'));
  const beam = document.getElementById('beam-2');
  const popupOverlay = document.getElementById('popupOverlay-2');
  const popupClose = document.getElementById('popupClose-2');
  const popupBody = document.getElementById('popupBody-2');

  let start, end, scrollRange;
  let focusedButtonIndex = -1;

  const popupContentData = [
    { title: "Popup for Button 1", content: "This is the unique content for the first button." },
    { title: "Information Panel 2", content: "Content for the second button appears here." },
    { title: "Details: Section 3", content: "The third popup provides more details." },
    { title: "Final Popup: Button 4", content: "And finally, the content for the fourth button." }
  ];

  const lerp = (start, end, t) => start * (1 - t) + end * t;

  function convertCmToPixels(cm) {
    const div = document.createElement('div');
    div.style.width = `${cm}cm`;
    div.style.position = 'absolute';
    document.body.appendChild(div);
    const pixels = div.offsetWidth;
    document.body.removeChild(div);
    return pixels;
  }

  function calculatePositions() {
    const buttonHeight = buttonContainer.offsetHeight;
    const buttonHalfHeight = buttonHeight / 2;
    const cmOffset = convertCmToPixels(2);

    const startTop = window.innerHeight / 2 + cmOffset;
    const endTop = cmOffset + buttonHalfHeight;

    start = {
      top: startTop,
      left: window.innerWidth / 2,
      translateY: 20
    };

    end = {
      top: endTop,
      left: window.innerWidth - convertCmToPixels(3) - 
        (window.innerWidth - convertCmToPixels(6) - convertCmToPixels(3)) / 2,
      translateY: 0
    };

    scrollRange = startTop - endTop;
  }

  function animateOnScroll() {
    const scrollY = window.scrollY;
    let progress = scrollY / scrollRange;
    progress = Math.max(0, Math.min(1, progress));

    const currentTop = lerp(start.top, end.top, progress);
    const currentLeft = lerp(start.left, end.left, progress);
    const currentTranslateY = lerp(start.translateY, end.translateY, progress);

    buttonContainer.style.top = `${currentTop}px`;
    buttonContainer.style.left = `${currentLeft}px`;
    buttonContainer.style.transform = `translate(-50%, -50%) translateY(${currentTranslateY}px)`;
  }

  async function animateBeamSequence() {
    beam.style.opacity = '1';
    const firstButtonRect = buttons[0].getBoundingClientRect();
    const verticalPos = firstButtonRect.top + firstButtonRect.height / 2 - beam.offsetHeight / 2;
    beam.style.transform = `translate(-200px, ${verticalPos}px)`;
    await new Promise(res => setTimeout(res, 100));

    for (let i = 0; i < buttons.length; i++) {
      const rect = buttons[i].getBoundingClientRect();
      const horizontalPos = rect.left + rect.width / 2 - beam.offsetWidth / 2;
      beam.style.transform = `translate(${horizontalPos}px, ${verticalPos}px)`;
      await new Promise(res => setTimeout(res, 400));
      buttons[i].classList.add("visible-2");
      await new Promise(res => setTimeout(res, 300));
    }

    beam.style.transform = `translate(${window.innerWidth + 200}px, ${verticalPos}px)`;
  }

  function openPopup(index) {
    const data = popupContentData[index];
    popupBody.innerHTML = `<h2>${data.title}</h2><p>${data.content}</p>`;
    popupOverlay.classList.add('visible-2');
  }

  function closePopup() {
    popupOverlay.classList.remove('visible-2');
    focusedButtonIndex = -1;
    updateFocus();
  }

  function handleButtonClick(index) {
    if (window.scrollY < scrollRange - 1) {
      window.scrollTo({ top: scrollRange, behavior: 'smooth' });
      window.addEventListener('scrollend', () => openPopup(index), { once: true });
    } else {
      openPopup(index);
    }
  }

  function updateFocus() {
    buttons.forEach((btn, i) => {
      btn.classList.toggle('focused-2', i === focusedButtonIndex);
    });
  }

  function handleKeyDown(e) {
    if (popupOverlay.classList.contains('visible-2')) {
      if (e.key === 'Escape') closePopup();
      return;
    }

    if (e.key === 'ArrowLeft') {
      focusedButtonIndex = (focusedButtonIndex > 0) ? focusedButtonIndex - 1 : buttons.length - 1;
      updateFocus();
    } else if (e.key === 'ArrowRight') {
      focusedButtonIndex = (focusedButtonIndex < buttons.length - 1) ? focusedButtonIndex + 1 : 0;
      updateFocus();
    } else if (e.key === 'Enter' && focusedButtonIndex !== -1) {
      handleButtonClick(focusedButtonIndex);
    }
  }

  window.addEventListener('scroll', animateOnScroll);
  window.addEventListener('resize', () => {
    calculatePositions();
    animateOnScroll();
  });
  window.addEventListener('keydown', handleKeyDown);

  buttons.forEach(button => {
    button.addEventListener('click', () => {
      const index = parseInt(button.dataset.index, 10);
      focusedButtonIndex = index;
      updateFocus();
      handleButtonClick(index);
    });
  });

  popupClose.addEventListener('click', closePopup);
  popupOverlay.addEventListener('click', (e) => {
    if (e.target === popupOverlay) closePopup();
  });

  calculatePositions();
  animateOnScroll();
  setTimeout(animateBeamSequence, 500);
}, 2500); // Delay start by 4 seconds
</script>

  <script src="script.js"></script>
</body>
</html>
